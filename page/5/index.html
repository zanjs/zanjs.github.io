<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.lug.ustc.edu.cn/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="zanjs, 赞生博客" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="一米阳光下，一本书，一个人，思念昉~">
<meta property="og:type" content="website">
<meta property="og:title" content="一点心怡 | 前端娃">
<meta property="og:url" content="http://zanjs.com/page/5/index.html">
<meta property="og:site_name" content="一点心怡 | 前端娃">
<meta property="og:description" content="一米阳光下，一本书，一个人，思念昉~">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="一点心怡 | 前端娃">
<meta name="twitter:description" content="一米阳光下，一本书，一个人，思念昉~">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://zanjs.com/page/5/"/>

  <title> 一点心怡 | 前端娃 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">一点心怡 | 前端娃</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">精于心, 简于形, 说前端</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/04/docker/1小时入门Docker精品文章/" itemprop="url">
                  1小时入门Docker精品文章
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-04T13:00:31+08:00" content="2016-02-04">
              2016-02-04
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/docker/" itemprop="url" rel="index">
                    <span itemprop="name">docker</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Docker是什么<br>Docker是软件工业中的容器技术。Docker为容器引入了镜像，使得容器可以从预先定义好的模版（images）创建出来，并且Docker镜像还是分层的。</p>
<h2 id="Docker经常被提起的特点："><a href="#Docker经常被提起的特点：" class="headerlink" title="Docker经常被提起的特点："></a>Docker经常被提起的特点：</h2><ul>
<li><p>轻量，体现在内存占用小，高密度</p>
</li>
<li><p>快速，毫秒启动</p>
</li>
<li><p>隔离，沙盒技术更像虚拟机</p>
</li>
</ul>
<h3 id="Docker技术的基础："><a href="#Docker技术的基础：" class="headerlink" title="Docker技术的基础："></a>Docker技术的基础：</h3><ul>
<li><p>namespace，容器隔离的基础，保证A容器看不到B容器. 6个名空间：User,Mnt,Network,UTS,IPC,Pid</p>
</li>
<li><p>cgroups，容器资源统计和隔离。主要用到的cgroups子系统：cpu,blkio,device,freezer,memory</p>
</li>
<li><p>unionfs，典型：aufs/overlayfs，分层镜像实现的基础</p>
</li>
</ul>
<h3 id="Docker组件："><a href="#Docker组件：" class="headerlink" title="Docker组件："></a>Docker组件：</h3><ul>
<li><p>docker Client客户端————&gt;向docker服务器进程发起请求，如:创建、停止、销毁容器等操作</p>
</li>
<li><p>docker Server服务器进程—–&gt;处理所有docker的请求，管理所有容器</p>
</li>
<li><p>docker Registry镜像仓库——&gt;镜像存放的中央仓库，可看作是存放二进制的scm</p>
</li>
</ul>
<h3 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h3><p>Docker的安装非常简单，支持目前所有主流操作系统，从Mac到Windows到各种Linux发行版</p>
<p>具体参考： <a href="https://docs.docker.com/installation/" target="_blank" rel="external">docker安装</a></p>
<h3 id="Docker常见命令"><a href="#Docker常见命令" class="headerlink" title="Docker常见命令"></a>Docker常见命令</h3><p>容器相关操作</p>
<ul>
<li><p>docker create # 创建一个容器但是不启动它</p>
</li>
<li><p>docker run # 创建并启动一个容器</p>
</li>
<li><p>docker stop # 停止容器运行，发送信号SIGTERM</p>
</li>
<li><p>docker start # 启动一个停止状态的容器</p>
</li>
<li><p>docker restart # 重启一个容器</p>
</li>
<li><p>docker rm # 删除一个容器</p>
</li>
<li><p>docker kill # 发送信号给容器，默认SIGKILL</p>
</li>
<li><p>docker attach # 连接(进入)到一个正在运行的容器</p>
</li>
<li><p>docker wait # 阻塞到一个容器，直到容器停止运行</p>
</li>
</ul>
<p>获取容器相关信息</p>
<ul>
<li><p>docker ps # 显示状态为运行（Up）的容器</p>
</li>
<li><p>docker ps -a # 显示所有容器,包括运行中（Up）的和退出的(Exited)</p>
</li>
<li><p>docker inspect # 深入容器内部获取容器所有信息</p>
</li>
<li><p>docker logs # 查看容器的日志(stdout/stderr)</p>
</li>
<li><p>docker events # 得到docker服务器的实时的事件</p>
</li>
<li><p>docker port # 显示容器的端口映射</p>
</li>
<li><p>docker top # 显示容器的进程信息</p>
</li>
<li><p>docker diff # 显示容器文件系统的前后变化</p>
</li>
</ul>
<h3 id="导出容器"><a href="#导出容器" class="headerlink" title="导出容器"></a>导出容器</h3><ul>
<li><p>docker cp # 从容器里向外拷贝文件或目录</p>
</li>
<li><p>docker export # 将容器整个文件系统导出为一个tar包，不带layers、tag等信息</p>
</li>
</ul>
<h3 id="执行"><a href="#执行" class="headerlink" title="执行"></a>执行</h3><p>docker exec # 在容器里执行一个命令，可以执行bash进入交互式</p>
<h3 id="镜像操作"><a href="#镜像操作" class="headerlink" title="镜像操作"></a>镜像操作</h3><ul>
<li><p>docker images # 显示本地所有的镜像列表</p>
</li>
<li><p>docker import # 从一个tar包创建一个镜像，往往和export结合使用</p>
</li>
<li><p>docker build # 使用Dockerfile创建镜像（推荐）</p>
</li>
<li><p>docker commit # 从容器创建镜像</p>
</li>
<li><p>docker rmi # 删除一个镜像</p>
</li>
<li><p>docker load # 从一个tar包创建一个镜像，和save配合使用</p>
</li>
<li><p>docker save # 将一个镜像保存为一个tar包，带layers和tag信息</p>
</li>
<li><p>docker history # 显示生成一个镜像的历史命令</p>
</li>
<li><p>docker tag # 为镜像起一个别名</p>
</li>
</ul>
<h3 id="镜像仓库-registry-操作"><a href="#镜像仓库-registry-操作" class="headerlink" title="镜像仓库(registry)操作"></a>镜像仓库(registry)操作</h3><ul>
<li><p>docker login # 登录到一个registry</p>
</li>
<li><p>docker search # 从registry仓库搜索镜像</p>
</li>
<li><p>docker pull # 从仓库下载镜像到本地</p>
</li>
<li><p>docker push # 将一个镜像push到registry仓库中</p>
</li>
</ul>
<h3 id="获取Container-IP地址（Container状态必须是Up）"><a href="#获取Container-IP地址（Container状态必须是Up）" class="headerlink" title="获取Container IP地址（Container状态必须是Up）"></a>获取Container IP地址（Container状态必须是Up）</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker inspect id | grep IPAddress | cut -d '"' -f 4</div></pre></td></tr></table></figure>
<h3 id="获取端口映射"><a href="#获取端口映射" class="headerlink" title="获取端口映射"></a>获取端口映射</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker inspect -f &apos;&#123;&#123;range $p, $conf := .NetworkSettings.Ports&#125;&#125; &#123;&#123;$p&#125;&#125; -&gt; &#123;&#123;(index $conf 0).HostPort&#125;&#125; &#123;&#123;end&#125;&#125;&apos; id</div></pre></td></tr></table></figure>
<h3 id="获取环境变量"><a href="#获取环境变量" class="headerlink" title="获取环境变量"></a>获取环境变量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker exec container_id env</div></pre></td></tr></table></figure>
<h3 id="杀掉所有正在运行的容器"><a href="#杀掉所有正在运行的容器" class="headerlink" title="杀掉所有正在运行的容器"></a>杀掉所有正在运行的容器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker kill $(docker ps -q)</div></pre></td></tr></table></figure>
<h3 id="删除老的-一周前创建-容器"><a href="#删除老的-一周前创建-容器" class="headerlink" title="删除老的(一周前创建)容器"></a>删除老的(一周前创建)容器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker ps -a | grep &apos;weeks ago&apos; | awk &apos;&#123;print $1&#125;&apos; | xargs docker rm</div></pre></td></tr></table></figure>
<h3 id="删除已经停止的容器"><a href="#删除已经停止的容器" class="headerlink" title="删除已经停止的容器"></a>删除已经停止的容器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker rm `docker ps -a -q`</div></pre></td></tr></table></figure>
<h3 id="删除所有镜像，小心"><a href="#删除所有镜像，小心" class="headerlink" title="删除所有镜像，小心"></a>删除所有镜像，小心</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker rmi $(docker images -q)</div></pre></td></tr></table></figure>
<h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><p>Dockerfile是自动构建Docker镜像的配置文件。也是Docker区别于其他容器的重要特征，正是有了Dockerfile，Docker的自动化和可移植性才成为可能。</p>
<p>不论是开发还是运维，学会编写Dockerfile几乎是必备的，这有助于你理解整个容器的运行。</p>
<h3 id="FROM-从一个基础镜像构建新的镜像"><a href="#FROM-从一个基础镜像构建新的镜像" class="headerlink" title="FROM , 从一个基础镜像构建新的镜像"></a><strong>FROM</strong> , 从一个基础镜像构建新的镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">FROM ubuntu</div></pre></td></tr></table></figure>
<h3 id="MAINTAINER-维护者信息"><a href="#MAINTAINER-维护者信息" class="headerlink" title="MAINTAINER , 维护者信息"></a>MAINTAINER , 维护者信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">MAINTAINER julian &lt;julaudme@gmail.com&gt;</div></pre></td></tr></table></figure>
<h3 id="ENV-设置环境变量"><a href="#ENV-设置环境变量" class="headerlink" title="ENV , 设置环境变量"></a>ENV , 设置环境变量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ENV TEST 1</div></pre></td></tr></table></figure>
<h3 id="RUN-非交互式运行shell命令"><a href="#RUN-非交互式运行shell命令" class="headerlink" title="RUN , 非交互式运行shell命令"></a>RUN , 非交互式运行shell命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">RUN apt-get -y update </div><div class="line"></div><div class="line">RUN apt-get -y install nginx</div></pre></td></tr></table></figure>
<h3 id="ADD-将外部文件拷贝到镜像里-src可以为url"><a href="#ADD-将外部文件拷贝到镜像里-src可以为url" class="headerlink" title="ADD , 将外部文件拷贝到镜像里,src可以为url"></a>ADD , 将外部文件拷贝到镜像里,src可以为url</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ADD http://zanjs.com/  /data/zanjs.tgz</div></pre></td></tr></table></figure>
<h3 id="WORKDIR-path-to-workdir-设置工作目录"><a href="#WORKDIR-path-to-workdir-设置工作目录" class="headerlink" title="WORKDIR /path/to/workdir, 设置工作目录"></a>WORKDIR /path/to/workdir, 设置工作目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">WORKDIR /var/www</div></pre></td></tr></table></figure>
<h3 id="USER-设置用户ID"><a href="#USER-设置用户ID" class="headerlink" title="USER , 设置用户ID"></a>USER , 设置用户ID</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">USER nginx</div></pre></td></tr></table></figure>
<h3 id="VULUME-lt-dir-gt-设置volume"><a href="#VULUME-lt-dir-gt-设置volume" class="headerlink" title="VULUME &lt;dir&gt;, 设置volume"></a><code>VULUME &lt;dir&gt;, 设置volume</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">VOLUME [‘/data’]</div></pre></td></tr></table></figure>
<h3 id="EXPOSE-暴露哪些端口"><a href="#EXPOSE-暴露哪些端口" class="headerlink" title="EXPOSE , 暴露哪些端口"></a>EXPOSE , 暴露哪些端口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">EXPOSE 80 443</div></pre></td></tr></table></figure>
<h3 id="ENTRYPOINT-‘executable’-‘param1’-’param2’-执行命令"><a href="#ENTRYPOINT-‘executable’-‘param1’-’param2’-执行命令" class="headerlink" title="ENTRYPOINT [‘executable’, ‘param1’,’param2’]执行命令"></a>ENTRYPOINT [‘executable’, ‘param1’,’param2’]执行命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ENTRYPOINT [&quot;/usr/sbin/nginx&quot;]</div></pre></td></tr></table></figure>
<h3 id="CMD-“param1”-”param2”"><a href="#CMD-“param1”-”param2”" class="headerlink" title="CMD [“param1”,”param2”]"></a>CMD [“param1”,”param2”]</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CMD [&quot;start&quot;]</div></pre></td></tr></table></figure>
<p>docker创建、启动container时执行的命令，如果设置了ENTRYPOINT，则CMD将作为参数</p>
<h3 id="Dockerfile最佳实践"><a href="#Dockerfile最佳实践" class="headerlink" title="Dockerfile最佳实践"></a>Dockerfile最佳实践</h3><ul>
<li>尽量将一些常用不变的指令放到前面</li>
<li>CMD和ENTRYPOINT尽量使用json数组方式</li>
</ul>
<h3 id="通过Dockerfile构建image"><a href="#通过Dockerfile构建image" class="headerlink" title="通过Dockerfile构建image"></a>通过Dockerfile构建image</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker build csphere/nginx:1.7 .</div></pre></td></tr></table></figure>
<h3 id="镜像仓库Registry"><a href="#镜像仓库Registry" class="headerlink" title="镜像仓库Registry"></a>镜像仓库Registry</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">镜像从Dockerfile build生成后，需要将镜像推送(push)到镜像仓库。</div><div class="line">企业内部都需要构建一个私有docker registry，这个registry可以看作二进制的scm，CI/CD也需要围绕registry进行。</div></pre></td></tr></table></figure>
<h3 id="部署registry"><a href="#部署registry" class="headerlink" title="部署registry"></a>部署registry</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir /registry</div><div class="line">docker run  -p 80:5000  -e STORAGE_PATH=/registry  -v /registry:/registry  registry:2.0</div></pre></td></tr></table></figure>
<h3 id="推送镜像保存到仓库"><a href="#推送镜像保存到仓库" class="headerlink" title="推送镜像保存到仓库"></a>推送镜像保存到仓库</h3><blockquote>
<p>假设192.168.1.2是registry仓库的地址</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">docker tag  csphere/nginx:1.7 192.168.1.2/csphere/nginx:1.7</div><div class="line">docker push 192.168.1.2/csphere/nginx:1.7</div></pre></td></tr></table></figure>
<h2 id="几个简单小例子"><a href="#几个简单小例子" class="headerlink" title="几个简单小例子"></a>几个简单小例子</h2><h3 id="容器操作"><a href="#容器操作" class="headerlink" title="容器操作"></a>容器操作</h3><ul>
<li>创建并拉取busybox</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"># docker run -it --name con01 busybox:latest</div><div class="line">/ # ip addr    #容器里执行</div><div class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default </div><div class="line">link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</div><div class="line">inet 127.0.0.1/8 scope host lo</div><div class="line">   valid_lft forever preferred_lft forever</div><div class="line">Segmentation fault (core dumped)</div><div class="line">/ # ping www.csphere.cn</div><div class="line">PING www.csphere.cn (117.121.26.243): 56 data bytes</div><div class="line">64 bytes from 117.121.26.243: seq=0 ttl=48 time=3.139 ms</div><div class="line">64 bytes from 117.121.26.243: seq=1 ttl=48 time=3.027 ms</div><div class="line">^C</div><div class="line">--- www.csphere.cn ping statistics ---</div><div class="line">2 packets transmitted, 2 packets received, 0% packet loss</div><div class="line">round-trip min/avg/max = 3.027/3.083/3.139 ms</div><div class="line">exit    #退出容器</div></pre></td></tr></table></figure>
<ul>
<li>创建测试容器</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">docker run -d --name con03 csphere/test:0.1</div><div class="line">efc9bda4a2ff2f479b18e0fc4698e42c47c9583a24c93f5ce6b28a828a172709</div></pre></td></tr></table></figure>
<ul>
<li>登陆到con03中</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># docker exec -it con03 /bin/bash</div><div class="line">[root@efc9bda4a2ff /]# exit</div></pre></td></tr></table></figure>
<ul>
<li>停止con03</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># docker stop con03</div><div class="line">con03</div></pre></td></tr></table></figure>
<ul>
<li>开启con03</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># docker start con03</div><div class="line">con03</div></pre></td></tr></table></figure>
<ul>
<li>删除con03</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># docker ps -a</div><div class="line">CONTAINER ID        IMAGE                    COMMAND                CREATED             STATUS                      PORTS                                             NAMES</div><div class="line">efc9bda4a2ff        csphere/test:0.1         &quot;/usr/local/bin/run    4 minutes ago       Up 17 seconds                                                                 con03               </div><div class="line">99aa6ee25adc        busybox:latest           &quot;/bin/sh&quot;              14 minutes ago      Exited (0) 12 minutes ago                                                     con02               </div><div class="line">831c93de9b9f        busybox:latest           &quot;/bin/sh&quot;              2 hours ago         Up 27 minutes                                                                 con01</div><div class="line"># docker rm con02     #容器停止的状态</div><div class="line"># docker rm -f con03  #容器开启的状态</div></pre></td></tr></table></figure>
<h2 id="镜像操作-1"><a href="#镜像操作-1" class="headerlink" title="镜像操作"></a>镜像操作</h2><h3 id="从docker-hub官方镜像仓库拉取镜像"><a href="#从docker-hub官方镜像仓库拉取镜像" class="headerlink" title="从docker hub官方镜像仓库拉取镜像"></a>从docker hub官方镜像仓库拉取镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># docker pull busybox:latest</div><div class="line">atest: Pulling from busybox</div><div class="line">cf2616975b4a: Pull complete </div><div class="line">6ce2e90b0bc7: Pull complete </div><div class="line">8c2e06607696: Already exists </div><div class="line">busybox:latest: The image you are pulling has been verified. Important: image verification is a tech preview feature and should not be relied on to provide security.</div><div class="line">Digest: sha256:38a203e1986cf79639cfb9b2e1d6e773de84002feea2d4eb006b52004ee8502d</div><div class="line">Status: Downloaded newer image for busybox:latest</div></pre></td></tr></table></figure>
<h3 id="从本地上传镜像到镜像仓库"><a href="#从本地上传镜像到镜像仓库" class="headerlink" title="从本地上传镜像到镜像仓库"></a>从本地上传镜像到镜像仓库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ker push 192.168.1.2/csphere/nginx:1.7</div></pre></td></tr></table></figure>
<h3 id="查找镜像仓库的某个镜像"><a href="#查找镜像仓库的某个镜像" class="headerlink" title="查找镜像仓库的某个镜像"></a>查找镜像仓库的某个镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># docker search centos/nginx</div><div class="line">NAME                                     DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</div><div class="line">johnnyzheng/centos-nginx-php-wordpress                                                   1                    [OK]</div><div class="line">sergeyzh/centos6-nginx                                                                   1                    [OK]</div><div class="line">hzhang/centos-nginx                                                                      1                    [OK]</div></pre></td></tr></table></figure>
<h3 id="查看本地镜像列表"><a href="#查看本地镜像列表" class="headerlink" title="查看本地镜像列表"></a>查看本地镜像列表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># docker images</div><div class="line">TAG                 IMAGE ID            CREATED             VIRTUAL SIZE</div><div class="line">docker.io/csphere/csphere   0.10.3              604c03bf0c9e        3 days ago          62.72 MB</div><div class="line">docker.io/csphere/csphere   latest              604c03bf0c9e        3 days ago          62.72 MB</div><div class="line">csphere/csphere             0.10.3              604c03bf0c9e        3 days ago          62.72 MB</div><div class="line">registry                    2.0                 2971b6ce766c        7 days ago          548.1 MB</div><div class="line">busybox                     latest              8c2e06607696        3 weeks ago         2.43 MB</div></pre></td></tr></table></figure>
<h3 id="删除镜像"><a href="#删除镜像" class="headerlink" title="删除镜像"></a>删除镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">docker rmi busybox:latest        #没有容器使用此镜像创建，如果有容器在使用此镜像会报错：Error response from daemon: Conflict, cannot delete 8c2e06607696 because the running container 831c93de9b9f is using it, stop it and use -f to force</div><div class="line">FATA[0000] Error: failed to remove one or more images</div><div class="line">docker rmi -f busybox:latest     #容器使用此镜像创建，此容器状态为Exited</div></pre></td></tr></table></figure>
<h3 id="查看构建镜像所用过的命令"><a href="#查看构建镜像所用过的命令" class="headerlink" title="查看构建镜像所用过的命令"></a>查看构建镜像所用过的命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># docker history busybox:latest</div><div class="line">IMAGE               CREATED             CREATED BY                                      SIZE</div><div class="line">8c2e06607696        3 weeks ago         /bin/sh -c #(nop) CMD [&quot;/bin/sh&quot;]               0 B</div><div class="line">6ce2e90b0bc7        3 weeks ago         /bin/sh -c #(nop) ADD file:8cf517d90fe79547c4   2.43 MB</div><div class="line">cf2616975b4a        3 weeks ago         /bin/sh -c #(nop) MAINTAINER Jérôme Petazzo     0 B</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/01/31/mongodb/ubuntu-mongodb-卸载/" itemprop="url">
                  ubuntu mongodb 卸载
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-31T11:44:47+08:00" content="2016-01-31">
              2016-01-31
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/数据库/" itemprop="url" rel="index">
                    <span itemprop="name">数据库</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/数据库/mongodb/" itemprop="url" rel="index">
                    <span itemprop="name">mongodb</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apt-get remove mongodb</div></pre></td></tr></table></figure>
<h3 id="彻底删除"><a href="#彻底删除" class="headerlink" title="彻底删除"></a>彻底删除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo apt-get autoremove</div><div class="line">sudo apt-get autoclean</div><div class="line"></div><div class="line">dpkg -l |grep ^rc|awk &apos;&#123;print $2&#125;&apos; |tr [&quot;\n&quot;] [&quot; &quot;]|sudo xargs dpkg -P -</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/01/23/javascript/Lo-Dash？引入惰性计算/" itemprop="url">
                  Lo-Dash？引入惰性计算
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-23T17:36:42+08:00" content="2016-01-23">
              2016-01-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我一直以为像 Lo-Dash 这样的库已经不能再快了，毕竟它们已经足够快了。<br> Lo-Dash 几乎完全混合了各种 JavaScript 奇技淫巧（YouTube）来压榨出最好的性能。</p>
<h2 id="惰性计算"><a href="#惰性计算" class="headerlink" title="惰性计算"></a>惰性计算</h2><p> 但似乎我错了 - 其实 Lo-Dash 可以运行的更快。<br> 你需要做的是，停止思考那些细微的优化，并开始找出更加适用的算法。<br> 例如，在一个典型的循环中，我们往往倾向于去优化单次迭代的时间</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> len = getLength();</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</div><div class="line">    operation(); <span class="comment">// &lt;- 10毫秒 - 如何优化到9毫秒?!</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码说明：取得数组的长度，然后重复执行 N 遍 operation() 函数。译注 by @justjavac</p>
<p>但是，这（优化 operation() 执行时间）往往很难，而且对性能提升也非常有限。</p>
<p> 相反，在某些情况下，我们可以优化 getLength() 函数。 它返回的数字越小，则每个 10 毫秒循环的执行次数就越少。</p>
<p>这就是 Lo-Dash 使用惰性计算的思想。 这是减少周期数，而不是减少每个周期的执行时间。 让我们看看下面的例子：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">priceLt</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">   <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123; <span class="keyword">return</span> item.price &lt; x; &#125;;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> gems = [</div><div class="line">   &#123; <span class="attr">name</span>: <span class="string">'Sunstone'</span>, <span class="attr">price</span>: <span class="number">4</span>  &#125;,</div><div class="line">   &#123; <span class="attr">name</span>: <span class="string">'Amethyst'</span>, <span class="attr">price</span>: <span class="number">15</span> &#125;,</div><div class="line">   &#123; <span class="attr">name</span>: <span class="string">'Prehnite'</span>, <span class="attr">price</span>: <span class="number">20</span> &#125;,</div><div class="line">   &#123; <span class="attr">name</span>: <span class="string">'Sugilite'</span>, <span class="attr">price</span>: <span class="number">7</span>  &#125;,</div><div class="line">   &#123; <span class="attr">name</span>: <span class="string">'Diopside'</span>, <span class="attr">price</span>: <span class="number">3</span>  &#125;, </div><div class="line">   &#123; <span class="attr">name</span>: <span class="string">'Feldspar'</span>, <span class="attr">price</span>: <span class="number">13</span> &#125;,</div><div class="line">   &#123; <span class="attr">name</span>: <span class="string">'Dioptase'</span>, <span class="attr">price</span>: <span class="number">2</span>  &#125;, </div><div class="line">   &#123; <span class="attr">name</span>: <span class="string">'Sapphire'</span>, <span class="attr">price</span>: <span class="number">20</span> &#125;</div><div class="line">];</div><div class="line"></div><div class="line"><span class="keyword">var</span> chosen = _(gems).filter(priceLt(<span class="number">10</span>)).take(<span class="number">3</span>).value();</div></pre></td></tr></table></figure>
<p>代码说明：gems 保存了 8 个对象，名字和价格。priceLt(x) 函数返回价格低于 x 的所有元素。译注 by @justjavac</p>
<p>我们把价格低于 10 美元的前 3 个 gems 找出来。 常规 Lo-Dash 方法（严格计算）是过滤所有 8 个 gems，然后返回过滤结果的前 3 个。</p>
<p><img src="http://justjavac.com/assets/images/lodash-naive.gif" alt=""></p>
<p>不难看出来，这种算法是不明智的。 它处理了所有的 8 个元素，而实际上我们只需要读取其中的 5 个元素就能得到我们想要的结果。<br> 与此相反，使用惰性计算算法，只需要处理能得到结果的最少数量就可以了。 如图所示：</p>
<p> <img src="http://justjavac.com/assets/images/grafika.gif" alt=""></p>
<p> 我们轻而易举就获得了 37.5％ 的性能提升。<br>  但是这还不是全部，其实很容易找到能获得 1000 倍以上性能提升的例子。 让我们一起来看看：</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">  <span class="comment">// 99,999 张照片</span></div><div class="line"><span class="keyword">var</span> phoneNumbers = [<span class="number">5554445555</span>, <span class="number">1424445656</span>, <span class="number">5554443333</span>, … ×<span class="number">99</span>,<span class="number">999</span>];</div><div class="line"></div><div class="line"><span class="comment">// 返回包含 "55" 的照片</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">contains55</span>(<span class="params">str</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> str.contains(<span class="string">"55"</span>); </div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 取 100 张包含 "55" 的照片</span></div><div class="line"><span class="keyword">var</span> r = _(phoneNumbers).map(<span class="built_in">String</span>).filter(contains55).take(<span class="number">100</span>);</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/01/10/javascript/JavaScript-数组常用方法介绍/" itemprop="url">
                  JavaScript 数组常用方法介绍
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-10T19:59:09+08:00" content="2016-01-10">
              2016-01-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="修改数组"><a href="#修改数组" class="headerlink" title="修改数组"></a>修改数组</h2><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/pop" target="_blank" rel="external">array.pop</a> - 删除数组最后一位元素。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">arr.pop();<span class="comment">// 返回 3</span></div><div class="line">arr;<span class="comment">// [1,2]</span></div></pre></td></tr></table></figure>
<ul>
<li>array.shift - 删除数组第一位元素。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">arr.shift();<span class="comment">// 返回 1</span></div><div class="line">arr;<span class="comment">// [2,3]</span></div></pre></td></tr></table></figure>
<ul>
<li>array.push - 往数组的末尾新增一个或多个元素。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [];</div><div class="line">arr.push(<span class="number">1</span>);<span class="comment">// 返回数组长度 1</span></div><div class="line">arr;<span class="comment">// [1]</span></div><div class="line">arr.push(<span class="number">2</span>,<span class="number">3</span>);</div><div class="line">arr;<span class="comment">// [1,2,3]</span></div></pre></td></tr></table></figure>
<ul>
<li>array.unshift - 往数组的开头新增一个或多个元素。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">arr.unshift(<span class="number">0</span>);</div><div class="line">arr.unshift(<span class="number">-1</span>, <span class="number">-2</span>);</div><div class="line">arr;<span class="comment">// [-1, -2, 0, 1, 2]</span></div></pre></td></tr></table></figure>
<ul>
<li>array.reverse - 把数组元素顺序逆转。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">arr.reverse();<span class="comment">// [3, 2, 1]</span></div><div class="line">arr;<span class="comment">// [3, 2, 1]</span></div></pre></td></tr></table></figure>
<ul>
<li>array.sort - 数组排序。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span> ,<span class="number">-1</span>, <span class="number">2</span>];</div><div class="line">arr.sort();<span class="comment">// [-1, 1, 2]</span></div><div class="line">arr;<span class="comment">// [-1, 1, 2]</span></div><div class="line">arr = [&#123;</div><div class="line">  age: <span class="number">10</span>,</div><div class="line">&#125;,&#123;</div><div class="line">  age: <span class="number">1</span></div><div class="line">&#125;, &#123;</div><div class="line">  age: <span class="number">12</span></div><div class="line">&#125;];</div><div class="line"><span class="comment">// 按照 age 从小到大排序</span></div><div class="line">arr.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> a.age - b.age &gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ul>
<li>array.splice - 给数组添加或者删除元素。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// splice(开始下标, 删除个数，插入元素(可以多个)）</span></div><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</div><div class="line">arr.splice(<span class="number">1</span>, <span class="number">2</span>);<span class="comment">// [2,3]</span></div><div class="line">arr;<span class="comment">// [1,4]</span></div><div class="line">arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</div><div class="line">arr.splice(<span class="number">1</span>, <span class="number">2</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>);<span class="comment">// [2,3]</span></div><div class="line">arr;<span class="comment">// [1, "a", "b", "c", 4]</span></div></pre></td></tr></table></figure>
<blockquote>
<p>注意：当数组执行上面的这些方法时，都会修改原数组。</p>
</blockquote>
<h2 id="迭代方法"><a href="#迭代方法" class="headerlink" title="迭代方法"></a>迭代方法</h2><ul>
<li>array.forEach - 遍历数组。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[<span class="string">'a'</span> ,<span class="string">'b'</span> ,<span class="string">'c'</span>].forEach(<span class="function"><span class="keyword">function</span>(<span class="params">each, index</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(each,index);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// 输出 'a' 0  'b' 1 'c' 2</span></div></pre></td></tr></table></figure>
<ul>
<li>array.filter - 从数组中找出所有符合指定条件的元素。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">// 找出所有正数</span></div><div class="line"><span class="keyword">var</span> res = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">-1</span>].filter(<span class="function"><span class="keyword">function</span>(<span class="params">each</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> each &gt; <span class="number">0</span>;</div><div class="line">&#125;);</div><div class="line">res; <span class="comment">//[3,4]</span></div></pre></td></tr></table></figure>
<ul>
<li>array.every - 数组中是否每个元素都满足指定的条件。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 是否都为正数</span></div><div class="line"><span class="keyword">var</span> isAllPositive = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">-1</span>].every(<span class="function"><span class="keyword">function</span>(<span class="params">each</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> each &gt; <span class="number">0</span>;</div><div class="line">&#125;);</div><div class="line">isAllPositive; <span class="comment">// false;</span></div><div class="line">isAllPositive = [<span class="number">3</span>, <span class="number">4</span>].every(<span class="function"><span class="keyword">function</span>(<span class="params">each</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> each &gt; <span class="number">0</span>;</div><div class="line">&#125;);</div><div class="line">isAllPositive; <span class="comment">// true;</span></div></pre></td></tr></table></figure>
<ul>
<li>array.some - 数组中是否有元素满足指定的条件。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 是否有正数</span></div><div class="line"><span class="keyword">var</span> isSomePositive = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">-1</span>].some(<span class="function"><span class="keyword">function</span>(<span class="params">each</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> each &gt; <span class="number">0</span>;</div><div class="line">&#125;);</div><div class="line">isSomePositive; <span class="comment">// true;</span></div><div class="line">isSomePositive = [<span class="number">-3</span>, <span class="number">-4</span>].every(<span class="function"><span class="keyword">function</span>(<span class="params">each</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> each &gt; <span class="number">0</span>;</div><div class="line">&#125;);</div><div class="line">isSomePositive; <span class="comment">// false;</span></div></pre></td></tr></table></figure>
<ul>
<li>array.map - 将数组映射成另一个数组。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 内容 * 2</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].map(<span class="function"><span class="keyword">function</span>(<span class="params">each</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> each * <span class="number">2</span>;</div><div class="line">&#125;);</div><div class="line"><span class="comment">// 返回 [2, 4, 6]</span></div></pre></td></tr></table></figure>
<ul>
<li>array.reduce - 将数组合成一个值。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 数组内容求和。0 为初始值</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].reduce(<span class="function"><span class="keyword">function</span>(<span class="params">prev, each</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> prev + each;</div><div class="line">&#125;, <span class="number">0</span>);</div><div class="line"><span class="comment">// 返回 6</span></div></pre></td></tr></table></figure>
<blockquote>
<p>当要使用迭代方法时，forEach 应该是最后被考虑的。<br>主要原因是：forEach 与其他迭代方法比，语义性是最差的。更详细的说明见 <a href="http://aeflash.com/2014-11/avoid-foreach.html" target="_blank" rel="external">avoid forEach</a>。</p>
</blockquote>
<p>注意 IE8 及以下版本不支持 every, some, map, reduce。<br>如果想在 IE 8 及以下版本用这几个方法，可以用 <a href="https://github.com/es-shims/es5-shim" target="_blank" rel="external">es5-shim</a> 或 <a href="https://lodash.com/" target="_blank" rel="external">lodash</a>。</p>
<h2 id="其他方法"><a href="#其他方法" class="headerlink" title="其他方法"></a>其他方法</h2><ul>
<li>Array.isArray - 是否是数组。IE9+ 支持该方法。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.isArray(<span class="number">3</span>); <span class="comment">// false</span></div><div class="line"><span class="built_in">Array</span>.isArray(&#123;&#125;); <span class="comment">// false</span></div><div class="line"><span class="built_in">Array</span>.isArray([]); <span class="comment">// true</span></div></pre></td></tr></table></figure>
<ul>
<li>array.concat - 合并数组或合并数组的值。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].concat(<span class="number">4</span>,<span class="number">5</span>); <span class="comment">// 输出 [1, 2, 3, 4, 5]</span></div></pre></td></tr></table></figure>
<ul>
<li>array.join - 合并数组所有元素拼接成字符串。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].join(); <span class="comment">// 输出 '1,2,3'</span></div><div class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].join(<span class="string">'@'</span>); <span class="comment">// 输出 '1@2@3'</span></div></pre></td></tr></table></figure>
<ul>
<li>array.slice - 选择数组中的一部分元素。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// slice(开始下标, 结束下标（可选，默认为数组长度）)</span></div><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>].slice(<span class="number">1</span>);<span class="comment">// ["b", "c", "d"]</span></div><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>].slice(<span class="number">1</span>, <span class="number">2</span>);<span class="comment">// ["b"]</span></div><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>].slice(<span class="number">1</span>, <span class="number">3</span>);<span class="comment">// ["b", "c"]</span></div></pre></td></tr></table></figure>
<ul>
<li>array.indexOf - 查找数组中指定元素的下标。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>].indexOf(<span class="string">'c'</span>); <span class="comment">// 2</span></div><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>].indexOf(<span class="string">'g'</span>); <span class="comment">// -1</span></div></pre></td></tr></table></figure>
<ul>
<li>array.lastIndexOf - 查找数组中指定元素的下标。查找方向为从后往前。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'c'</span>].lastIndexOf(<span class="string">'c'</span>); <span class="comment">// 2</span></div><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>].lastIndexOf(<span class="string">'g'</span>); <span class="comment">// -1</span></div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/27/erlang/用-Elixir-的一周/" itemprop="url">
                  用 Elixir 的一周
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-27T16:38:08+08:00" content="2015-12-27">
              2015-12-27
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Elixir/" itemprop="url" rel="index">
                    <span itemprop="name">Elixir</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>大约一周前我开始学习Elixir. 关于这个我也只是有些模糊的印象但还没有仔细去看。</p>
<p>但在Dave Thomas 出版了 <a href="https://pragprog.com/book/elixir/programming-elixir" target="_blank" rel="external">Programming Elixir</a>之后一切都发生了改变.<br> Dave Thomas 帮我修订过Erlang这本书并且是Ruby的倡导者, 只要Dave对什么产生了兴趣那绝不是空穴来风.</p>
<p> Dave 对Elixir很感兴趣, 在他的书里这样写道:</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"> I came across Ruby in 1998 because I was an avid </div><div class="line">reader of comp.lang.misc (ask your parents). I </div><div class="line">downloaded it, compiled it, and fell in love. </div><div class="line">As with any time you fall in love,</div><div class="line">it’s difficult to explain why. </div><div class="line">It just worked the way I work, </div><div class="line">and it had enough depth to keep me interested.</div><div class="line"></div><div class="line">Fast forward 15 years. All that time I’d been </div><div class="line">looking for something new that gave me the same feeling.</div><div class="line"></div><div class="line">I came across Elixir a while back, but for some </div><div class="line">reason never got stuck in. But a few months ago I </div><div class="line">was chatting with Corey Haines. I was</div><div class="line">bemoaning the fact that I wanted to find a </div><div class="line">way to show people functional programming concepts </div><div class="line">without the kind of academic trappings those books </div><div class="line">seem to attract. He told me to look again at Elixir. I</div><div class="line">did, and I felt the same way I felt when I first saw Ruby.</div></pre></td></tr></table></figure>
<p> 我能体会.纯粹的感官体验. 就像我知道一件事是对的但还不知道原因，<br> 几周甚至几年后这个问题总能回答出来. Malcolm Gladwell在Blink:<br> The Power of Thinking Without Thinking一书中曾探讨过这个问题.<br> 某些领域专家们总能凭直觉判断事情的正确与否，但却给不出具体原因.</p>
<p>但我发现Dave 的描述后，我很想知道为什么他会这样.</p>
<p>无独有偶, Simon St. Laurent也出了本Elixir的书.<br>Simon的 Introducing Erlang… 一书表现不俗，我和他还通过邮件沟通过几次，还有有些熟悉的.<br>从Pragmatic Press 和O’Reilly 出版社都在争着出版Elixir可见一斑。关于Erlang VM, 我确实一窍不通。</p>
<p>我给Dave和Simon 发了封邮件，之后他们借给我了样书，现在可以开始阅读了 …  谢了 …</p>
<h3 id="上周我下载了elixir-开始学习…"><a href="#上周我下载了elixir-开始学习…" class="headerlink" title="上周我下载了elixir 开始学习…"></a>上周我下载了elixir 开始学习…</h3><p>没多久我觉得就上手了. 确实好东西. 有趣的是Erlang和Elixir 实际上是同源的.<br>事实上也确实这样，他们都会被EVM (Erlang Virtual Machine)编译 -<br>大家管这个EVM 叫 “Beam” VM 但为了和JVM区别就管他叫EVM 吧.</p>
<p>Erlang和Elixir为啥有相同的“语意”? 这得从底层谈起.<br>垃圾回收, 独立并发机制, 错误处理和代码装载机制都是一样的.<br> 还有: 他们都运行在相同的VM里. 这也是Scala 和 Akka区别于 Erlang的原因.<br>Scala和Akka是运行在JVM 上的, 垃圾回收和代码装载机制从本质上就不同.</p>
<p>Elixir最明显的特点就是语法的表示，和Ruby很像.  简单易懂，还有很多外部资源。</p>
<p>Erlang’s 的语法源自 Prolog 还受到smalltalk, CSP 和功能性编程语言的影响.<br> Elixir 受到Erlang 和Ruby的影响. 类型匹配, 功能优先级错误处理机制都是从Erlang来的.sigils,<br> 语法简写从Ruby 来。 当然也有自己的创新,  |&gt; 管道操作, Prologs DCGs 和Haskell monads<br> (简化了一些类似于Unix的管道操作) 宏引用,是从lisp quasiquote得来，还有逗号操作符.</p>
<p>Elixir更新了AST机制 , 和Erlang AST独有展示的模式不同,<br> Elixir AST 统一了模式这使得meta-programming 更简单.</p>
<p> 实现起来也中规中矩，只是有几处需要注意. 字符串插入 (主意不错) ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">IO.puts &quot;...#&#123;x&#125;...&quot;</div></pre></td></tr></table></figure>
<p>获取x并按格式打印出来. 但只对简单模式的x起作用.</p>
<p> 这可以通过从Elixir调用Erlang的方法来弥补</p>
<p> IO.puts “…#{pp(x)}…” 就可以. 只是需要把 pp(x) 改成</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"> def pp(x) do </div><div class="line">    :io_lib.format(&quot;~p&quot;, [x])</div><div class="line">    |&gt; :lists.flatten</div><div class="line">    |&gt; :erlang.list_to_binary</div><div class="line">end</div></pre></td></tr></table></figure>
<p> Erlang 描述如下:</p>
 <figure class="highlight erlang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">pp</span><span class="params">(X)</span> -&gt;</span></div><div class="line"> list_to_binary(lists_flatten(li_lib:format(<span class="string">"~p),[X])))</span></div></pre></td></tr></table></figure>
<p> 这和Elixir的描述一样. Elixir的写法也更容易阅读. |&gt; 操作符用来把io_lib:format 的结果输入到<br> lists:flatten 然后再到list_to_binary. 跟unix的管道符|一样</p>
<p> Elixir区别与Erlang在 - 变量可复用.<br>  结果集始终可以表示为static-single-assignment (SSA) .<br>  但在循环结构里千万别这么做.好在 Elixir只用了递归而没有循环结构.<br>  如果循环结构里引用了可变的参数，那远端EVM就没法编译了.<br>  当在SSA顺序结构中使用变量时, EVM 就知道如何处理.循环结构Elixir就没办法了.<br>  其根源可追溯到LLVM汇编- 那就是另一个问题了.</p>
<h2 id="编程语言设计的三定律"><a href="#编程语言设计的三定律" class="headerlink" title="编程语言设计的三定律"></a>编程语言设计的三定律</h2><ul>
<li><p>你做对的，无人为你提。</p>
</li>
<li><p>你做错的，有人跟你急。</p>
</li>
<li><p>难点必须不断重复解释。</p>
</li>
</ul>
<p>有些语言在一些方面做得很好，它们正确，优雅，易于理解，但没人不辞麻烦地提及这些。</p>
<p>错误的地方非常糟糕。你成了笨蛋，如果好处比重大于坏处，你可能被原谅。那些你想在以后消除的坏处，<br>却因为向后兼容性或者是有些傻子（或曰你的狂粉）已经用所有那些坏处写了无数行代码等原因，而不能动。</p>
<p>难以理解的内容是真正倒霉的事情。你必须一遍又一遍地解释，直到你吐血，可还是有些人永远不懂，<br>你必须写上百邮件和数千文字来一遍又一遍地解释这些内容是什么意思以及它们为什么会如此。<br>对于一个语言的设计者或作者来说，这是一个痛苦的深渊。</p>
<p>我将要提到的几件事就是我认为落入这三类情况中的。</p>
<p>在我开始前，我要说 Elixir 做对了好多好多的事情，好处远远大于坏处。</p>
<p>关于 Elixir 的好处是，及时改正它的坏处还不算晚。<br>这只能在无数代码行被写下和众多程序员开始使用它之前才能做到——所以只有少数时间来解决这些问题了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/12/nginx/MAC使用brew安装nginx-php-mysql环境/" itemprop="url">
                  MAC使用brew安装nginx+php+mysql环境
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-12T15:31:01+08:00" content="2015-12-12">
              2015-12-12
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/php/" itemprop="url" rel="index">
                    <span itemprop="name">php</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="安装-homebrew"><a href="#安装-homebrew" class="headerlink" title="安装 homebrew"></a>安装 homebrew</h2><blockquote>
<p>参考资料：<a href="http://brew.sh/index_zh-cn.html" target="_blank" rel="external">http://brew.sh/index_zh-cn.html</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ruby -e &quot;$(curl -fsSL https://raw.github.com/Homebrew/homebrew/go/install)&quot;</div></pre></td></tr></table></figure>
<h2 id="安装-nginx"><a href="#安装-nginx" class="headerlink" title="安装 nginx"></a>安装 nginx</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install nginx</div></pre></td></tr></table></figure>
<h3 id="nginx-的操作命令："><a href="#nginx-的操作命令：" class="headerlink" title="nginx 的操作命令："></a>nginx 的操作命令：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$打开 nginx</div><div class="line">sudo nginx</div><div class="line">$重新加载配置|重启|停止|退出 nginx</div><div class="line">nginx -s reload|reopen|stop|quit</div><div class="line">$测试配置是否有语法错误</div><div class="line">nginx -t</div></pre></td></tr></table></figure>
<p>启动 nginx 后，默认的开启的是8080端口，可以通过修改配置文件来设置端口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vi /usr/local/etc/nginx/nginx.conf</div></pre></td></tr></table></figure>
<p>默认访问的目录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/Cellar/nginx/1.8.0/html</div></pre></td></tr></table></figure>
<h3 id="开机启动"><a href="#开机启动" class="headerlink" title="开机启动"></a>开机启动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mkdir -p ~/Library/LaunchAgents</div><div class="line">cp /usr/local/Cellar/nginx/1.8.0/homebrew.mxcl.nginx.plist ~/Library/LaunchAgents/</div><div class="line">launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.nginx.plist</div></pre></td></tr></table></figure>
<p>设置权限：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo chown root:wheel /usr/local/Cellar/nginx/1.8.0/bin/nginx</div><div class="line">sudo chmod u+s /usr/local/Cellar/nginx/1.8.0/bin/nginx</div></pre></td></tr></table></figure>
<h2 id="安装mysql"><a href="#安装mysql" class="headerlink" title="安装mysql"></a>安装mysql</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install mysql</div></pre></td></tr></table></figure>
<h3 id="配置mysql数据库："><a href="#配置mysql数据库：" class="headerlink" title="配置mysql数据库："></a>配置mysql数据库：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql_install_db --verbose --user=`whoami` --basedir=&quot;$(brew --prefix mysql)&quot; --datadir=/usr/local/var/mysql --tmpdir=/tmp</div></pre></td></tr></table></figure>
<p>执行完成后就可以在终端中运行 mysql 命令了。</p>
<p>这里需要注意一下，我们可以不需要密码就可以进入 mysql，可以通过一些安全设置、设置用户密码来保证安全性。</p>
<p>设置 mysql 开机启动：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mkdir -p ~/Library/LaunchAgents/</div><div class="line">cp /usr/local/Cellar/mysql/5.6.17/homebrew.mxcl.mysql.plist ~/Library/LaunchAgents/</div><div class="line">launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist</div></pre></td></tr></table></figure>
<p>mysql 配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/Cellar/mysql/5.6.17/my.cnf</div></pre></td></tr></table></figure>
<h2 id="安装-php"><a href="#安装-php" class="headerlink" title="安装 php"></a>安装 php</h2><p>MAC本来就自带了 php，但是很多扩展没有安装，所以选择了重新安装php。</p>
<p>首先，我们需要安装第三方程序包。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">brew tap homebrew/dupes</div><div class="line">brew tap josegonzalez/homebrew-php</div></pre></td></tr></table></figure>
<p>我们可以查看下 brew 下有那些 php 版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew search php</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install php55 --with-imap --with-tidy --with-debug --with-pgsql --with-mysql --with-fpm</div></pre></td></tr></table></figure>
<p>更多的php选项可以通过以下命令查看：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew options php55</div></pre></td></tr></table></figure>
<p>由于是重装php，之前系统预装的php还没卸载，因此在终端调用php时，还是以之前系统的php版本做解析，<br>所以这里需要修改path，指定 php 的解析路径。在~/.bashrc（没有则创建）最后加入一行：</p>
<p>export PATH=”$(brew –prefix php55)/bin:$PATH”</p>
<p>执行一下 source 使之生效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">source ./.profile</div></pre></td></tr></table></figure>
<p>php 配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/etc/php/5.5/php.ini</div></pre></td></tr></table></figure>
<p>php-fpm 配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/etc/php/5.5/php-fpm.conf</div></pre></td></tr></table></figure>
<p>启动 php-fpm 的话就直接在终端里执行 “php-fpm”，默认打开 php-fpm 会显示一个状态 shell 出来，<br>也可以把 php-fpm 的配置文件里的 “daemonize = no” 改为 “daemonize = yes”，就会以后台守护进程的方式启动，<br>对于刚修改的配置文件，可以执行 “php-fpm -t” 来检测配置有没有问题。</p>
<p>开机启动php-fpm:</p>
<p>mkdir -p ~/Library/LaunchAgents<br>cp /usr/local/Cellar/php55/5.5.26/homebrew-php.josegonzalez.php55.plist ~/Library/LaunchAgents/<br>launchctl load -w ~/Library/LaunchAgents/homebrew-php.josegonzalez.php55.plist</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/22/webpack/设置webpack实现React项目的hot-load/" itemprop="url">
                  设置webpack实现React项目的hot load
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-11-22T13:38:36+08:00" content="2015-11-22">
              2015-11-22
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>编写了简单的项目: <a href="https://github.com/MarshalW/react-proto/tree/m1" target="_blank" rel="external">react-proto m1</a>。用来说明如何设置简单的React开发环境。<br>通过webpack及其插件 <a href="https://github.com/gaearon/react-hot-loader" target="_blank" rel="external">react-hot-loader</a>，实现js/jsx代码修改后，浏览器中的网页能自动加载js。</p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>安装webpack，见 <a href="http://webpack.github.io/docs/tutorials/getting-started/" target="_blank" rel="external">webpack getting started</a>。</p>
<h2 id="导入项目及运行"><a href="#导入项目及运行" class="headerlink" title="导入项目及运行"></a>导入项目及运行</h2><p>见这里：<a href="https://github.com/MarshalW/react-proto/blob/master/README.md#%E5%AE%89%E8%A3%85%E4%B8%8E%E8%BF%90%E8%A1%8C" target="_blank" rel="external">README.md#安装与运行</a>。</p>
<p>运行的截图：</p>
<p><img src="http://marshal.ohtly.com/images/browser-react-hot-loader.png" alt="react"></p>
<p>相关文件的说明</p>
<ul>
<li>webpack.config.js：webpack的配置文件</li>
<li>server.js：用于开发阶段测试使用的webserver</li>
<li>index.html：webapp的网页</li>
<li>scripts目录：存放js脚本<ul>
<li>index.js：js入口文件</li>
<li>App.js：webapp js的入口文件，这里使用了ES6的语法，webpack使用了babel将ES6语法代码转换成ES5的代码</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/21/Create-a-character-voting-app-using-React-Node-js-MongoDB-and-Socket-IO/" itemprop="url">
                  Create a character voting app using React, Node.js, MongoDB and Socket.IO
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-11-21T11:38:11+08:00" content="2015-11-21">
              2015-11-21
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Update-Notice-2-November-12-2015"><a href="#Update-Notice-2-November-12-2015" class="headerlink" title="Update Notice 2 (November 12, 2015)"></a>Update Notice 2 (November 12, 2015)</h3><p>Tutorial has been updated to use <a href="https://medium.com/@malyw/how-to-update-babel-5-x-6-x-d828c230ec53" target="_blank" rel="external">Babel</a> 6.0 and<br> React <a href="https://github.com/rackt/react-router/releases/tag/v1.0.0" target="_blank" rel="external">Router 1.0</a>. For detailed tutorial updates see November 12, 2015 notes below.</p>
<h3 id="Update-Notice-1-October-19-2015"><a href="#Update-Notice-1-October-19-2015" class="headerlink" title="Update Notice 1 (October 19, 2015)"></a>Update Notice 1 (October 19, 2015)</h3><p>Tutorial has been updated to use React 0.14 and React Router 1.0-rc3 that introduced breaking changes.<br>For detailed tutorial updates see October 19, 2015 notes below.</p>
<h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>In this tutorial we are going to build a character voting app (inspired by Facemash and Hot or Not)<br>for <a href="http://www.eveonline.com/" target="_blank" rel="external">EVE Online</a> - a massively multiplayer online game.<br>Be sure to play this awesome soundtrack below to get yourself in the mood for this epicly long tutorial.</p>
<p>While listening to this soundtrack, imagine yourself mining asteroid belts in deep space while<br>keeping a lookout for pirates on the radar, researching propulsion system blueprints at the station’s facility,<br>manufacturing spaceship components for capital ships, placing buy &amp; sell orders on the entirely<br>player-driven market where supply and demand govern the game economics, hauling trade goods from a remote solar system<br>in a massive freighter, flying blazingly fast interceptors with a microwarpdrive or powerful battleships armored to<br>the teeth, optimizing extraction efficiency of rare minerals from planets,<br>or fighting large-scale battles with thousands of players from multiple alliances. That is <strong><em> EVE Online </em></strong>.</p>
<p>Each player in EVE Online has a 3D avatar representing their character.<br>This app is designed for ranking those avatars. Anyway, your goal here is to learn about Node.js,<br>React and Flux, not EVE Online. But I will say this: “Having an interesting tutorial project is just as important,<br>if not more so, than the main subject of the tutorial”.<br>The only reason I built the original New Eden Faces app is to learn Backbone.js and the only reason I built the<br> TV Show Tracker app is so that I could learn AngularJS. To me, either one of these projects is far more<br> interesting than a simple todo app that everyone seems to be using these days.</p>
<p> One thing that I have learned — between screencasts, books and training videos,<br> nothing is more effective than building a small project that you are passionate about to learn a new technology.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/20/javascript/JavaScript-异步方案-async-await/" itemprop="url">
                  JavaScript 异步方案 async/await
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-11-20T21:57:18+08:00" content="2015-11-20">
              2015-11-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>构建一个应用程序总是会面对异步调用，不论是在 Web 前端界面，还是 Node.js 服务端都是如此，JavaScript 里面处理异步调用一直是非常恶心的一件事情。<br>以前只能通过回调函数，后来渐渐又演化出来很多方案，最后 Promise 以简单、易用、兼容性好取胜，但是仍然有非常多的问题。<br>其实 JavaScript 一直想在语言层面彻底解决这个问题，在 ES6 中就已经支持原生的 Promise，还引入了 Generator 函数，终于在 ES7 中决定支持 async 和 await。</p>
<h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><p>async/await 究竟是怎么解决异步调用的写法呢？简单来说，就是将异步操作用同步的写法来写。先来看下最基本的语法（ES7 代码片段）：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      resolve(<span class="number">123</span>);</div><div class="line">    &#125;, <span class="number">2000</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> testAsync = <span class="keyword">async</span> () =&gt; &#123;</div><div class="line">  <span class="keyword">const</span> t = <span class="keyword">await</span> f();</div><div class="line">  <span class="built_in">console</span>.log(t);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">testAsync();</div></pre></td></tr></table></figure>
<p>首先定义了一个函数 <code>f</code>，这个函数返回一个 <code>Promise</code>，并且会延时 2 秒，<code>resolve</code> 并且传入值 123。<code>testAsync</code> 函数在定义时使用了关键字 <code>async</code>，<br>然后函数体中配合使用了 <code>await</code>，最后执行 <code>testAsync</code>。整个程序会在 2 秒后输出 123，也就是说 <code>testAsync</code> 中常量 t 取得了 <code>f</code>中 <code>resolve</code> 的值，<br>并且通过 <code>await</code> 阻塞了后面代码的执行，直到 <code>f</code>这个异步函数执行完。</p>
<h2 id="对比-Promise"><a href="#对比-Promise" class="headerlink" title="对比 Promise"></a>对比 Promise</h2><p>仅仅是一个简单的调用，就已经能够看出来 <code>async/await</code> 的强大，写码时可以非常优雅地处理异步函数，彻底告别回调恶梦和无数的 then 方法。<br>我们再来看下与 <code>Promise</code> 的对比，同样的代码，如果完全使用 <code>Promise</code> 会有什么问题呢？</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      resolve(<span class="number">123</span>);</div><div class="line">    &#125;, <span class="number">2000</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> testAsync = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  f().then(<span class="function">(<span class="params">t</span>) =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(t);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">testAsync();</div></pre></td></tr></table></figure>
<p>从代码片段中不难看出 <code>Promise</code> 没有解决好的事情，比如要有很多的 then 方法，整块代码会充满 <code>Promise</code> 的方法，而不是业务逻辑本身，<br>而且每一个 <code>then</code> 方法内部是一个独立的作用域，要是想共享数据，就要将部分数据暴露在最外层，在 then 内部赋值一次。<br>虽然如此，<code>Promise</code> 对于异步操作的封装还是非常不错的，所以 <code>async/await</code> 是基于 <code>Promise</code> 的，await 后面是要接收一个 Promise 实例。</p>
<h2 id="对比-RxJS"><a href="#对比-RxJS" class="headerlink" title="对比 RxJS"></a>对比 RxJS</h2><p>RxJS 也是非常有意思的东西，用来处理异步操作，它更能处理基于流的数据操作。<br>举个例子，比如在 Angular2 中 http 请求返回的就是一个 RxJS 构造的 Observable Object，我们就可以这样做：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">$http.get(url)</div><div class="line">  .map(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> value + <span class="number">1</span>;</div><div class="line">  &#125;)</div><div class="line">  .filter(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> value !== <span class="literal">null</span>;</div><div class="line">  &#125;)</div><div class="line">  .forEach(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(value);</div><div class="line">  &#125;)</div><div class="line">  .subscribe(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'do something.'</span>);</div><div class="line">  &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(err);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<p>如果是 ES6 代码可以进一步简洁：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$http.get(url) </div><div class="line">  .map(<span class="function"><span class="params">value</span> =&gt;</span> value + <span class="number">1</span>) </div><div class="line">  .filter(<span class="function"><span class="params">value</span> =&gt;</span> value !== <span class="literal">null</span>) </div><div class="line">  .forEach(<span class="function"><span class="params">value</span> =&gt;</span> <span class="built_in">console</span>.log(value)) </div><div class="line">  .subscribe(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123; </div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'do something.'</span>); </div><div class="line">  &#125;, (err) =&gt; &#123; </div><div class="line">    <span class="built_in">console</span>.log(err); </div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<p>可以看出 RxJS 对于这类数据可以做一种类似流式的处理，也是非常优雅，<br>而且 RxJS 强大之处在于你还可以对数据做取消、监听、节流等等的操作，这里不一一举例了，感兴趣的话可以去看下 RxJS 的 API。</p>
<p>这里要说明一下的就是 RxJS 和 async/await 一起用也是可以的，Observable Object 中有 toPromise 方法，可以返回一个 Promise Object，<br>同样可以结合 await 使用。<br>当然你也可以只使用 async/await 配合 underscore 或者其他库，也能实现很优雅的效果。总之，RxJS 与 async/await 不冲突。</p>
<h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><p>通过使用 async/await，我们就可以配合 try/catch 来捕获异步操作过程中的问题，包括 Promise 中 reject 的数据。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      reject(<span class="number">234</span>);</div><div class="line">    &#125;, <span class="number">2000</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> testAsync = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">const</span> t = <span class="keyword">await</span> f();</div><div class="line">    <span class="built_in">console</span>.log(t);</div><div class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</div><div class="line">    <span class="built_in">console</span>.log(err);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">testAsync();</div></pre></td></tr></table></figure>
<p>代码片段中将 f 方法中的 <code>resolve</code> 改为 reject，在 testAsync 中，通过 <code>catch</code> 可以捕获到 <code>reject</code> 的数据，输出 err 的值为 234。<br><code>try/catch</code> 使用时也要注意范围和层级。如果 try 范围内包含多个 await，那么 catch 会返回第一个 <code>reject</code> 的值或错误。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> f1 = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      reject(<span class="number">111</span>);</div><div class="line">    &#125;, <span class="number">2000</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> f2 = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      reject(<span class="number">222</span>);</div><div class="line">    &#125;, <span class="number">3000</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> testAsync = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">const</span> t1 = <span class="keyword">await</span> f1();</div><div class="line">    <span class="built_in">console</span>.log(t1);</div><div class="line">    <span class="keyword">const</span> t2 = <span class="keyword">await</span> f2();</div><div class="line">    <span class="built_in">console</span>.log(t2);</div><div class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</div><div class="line">    <span class="built_in">console</span>.log(err);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">testAsync();</div></pre></td></tr></table></figure>
<p>如代码片段所示，testAsync 函数体中 try 有两个 await 函数，而且都分别 reject，那么 catch 中仅会触发 f1 的 reject，输出的 err 值是 111。</p>
<h2 id="开始使用"><a href="#开始使用" class="headerlink" title="开始使用"></a>开始使用</h2><p>无论是 Web 前端还是 Node.js 服务端，都可以通过预编译的手段实现使用 ES6 和 ES7 来写代码，<br>目前最流行的方案是通过 Babel 将使用 ES7、ES6 写的代码编译为 E6 或 ES5 的代码来执行。</p>
<h2 id="Node-js-服务端配置"><a href="#Node-js-服务端配置" class="headerlink" title="Node.js 服务端配置"></a>Node.js 服务端配置</h2><p>服务端使用 Babel，最简单的方式是通过 require hook。</p>
<p>首先安装 Babel：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install babel-core --save</div></pre></td></tr></table></figure>
<p>安装 async/await 支持：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install babel-preset-stage-3 --save</div></pre></td></tr></table></figure>
<p>在服务端代码的根目录中配置 .babelrc 文件，内容为：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"presets"</span>: [<span class="string">"stage-3"</span>]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在顶层代码文件（server.js 或 app.js 等）中引入 Babel 模块：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>(<span class="string">"babel-core/register"</span>);</div></pre></td></tr></table></figure>
<p>在这句后面引入的模块，都将会自动通过 babel 编译，但当前文件不会被 babel 编译。<br>另外，需要注意 Node.js 的版本，如果是 4.0 以上的版本则默认支持绝大部分 ES6，可以直接启动。<br>但是如果是 0.12 左右的版本，就需要通过 node —harmory 来启动才能够支持。因为 stage-3 模式，Babel 不会编译基本的 ES6 代码，<br>环境既然支持又何必要编译为 ES5？这样做也是为了提高性能和编译效率。</p>
<h2 id="配置-Web-前端构建"><a href="#配置-Web-前端构建" class="headerlink" title="配置 Web 前端构建"></a>配置 Web 前端构建</h2><p>可以通过增加 Gulp 的预编译 task 来支持。</p>
<p>首先安装 gulp-babel 插件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install gulp-babel --save-dev</div></pre></td></tr></table></figure>
<p>然后编写配置：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> babel = <span class="built_in">require</span>(<span class="string">'gulp-babel'</span>);</div><div class="line"></div><div class="line">gulp.task(<span class="string">'babel'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'src/app.js'</span>)</div><div class="line">    .pipe(babel())</div><div class="line">    .pipe(gulp.dest(<span class="string">'dist'</span>));</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>除了 Gulp-babel 插件，也可以使用官方的 Babel-loader 结合 Webpack 或 Browserify 使用。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/10/31/mongodb/Mac-OX上安装MongoDb/" itemprop="url">
                  Mac OX上安装MongoDb
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-10-31T08:53:53+08:00" content="2015-10-31">
              2015-10-31
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/数据库/" itemprop="url" rel="index">
                    <span itemprop="name">数据库</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="install-MongoDb"><a href="#install-MongoDb" class="headerlink" title="install MongoDb"></a>install MongoDb</h2><blockquote>
<p>更新Homebrew的package数据库，在Mac的终端中输入：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ brew update</div></pre></td></tr></table></figure>
<p>然后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ brew install mongodb</div></pre></td></tr></table></figure>
<p>等待MongoDb下载完成。这个比较贴心了，有下载进度百分比。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">julauddeMacBook-Pro:/ julaud$ brew install mongodb</div><div class="line">==&gt; Downloading https://homebrew.bintray.com/bottles/mongodb-3.0.7.yosemite.bott</div><div class="line">Already downloaded: /Library/Caches/Homebrew/mongodb-3.0.7.yosemite.bottle.tar.gz</div><div class="line">==&gt; Pouring mongodb-3.0.7.yosemite.bottle.tar.gz</div><div class="line">==&gt; Caveats</div><div class="line">To have launchd start mongodb at login:</div><div class="line">  ln -sfv /usr/local/opt/mongodb/*.plist ~/Library/LaunchAgents</div><div class="line">Then to load mongodb now:</div><div class="line">  launchctl load ~/Library/LaunchAgents/homebrew.mxcl.mongodb.plist</div><div class="line">Or, if you don&apos;t want/need launchctl, you can just run:</div><div class="line">  mongod --config /usr/local/etc/mongod.conf</div><div class="line">==&gt; Summary</div><div class="line">🍺  /usr/local/Cellar/mongodb/3.0.7: 17 files, 158M</div></pre></td></tr></table></figure>
<h2 id="启动MongoDb"><a href="#启动MongoDb" class="headerlink" title="启动MongoDb"></a>启动MongoDb</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">🍺  /usr/local/Cellar/mongodb/3.0.7: 17 files, 158M</div><div class="line">julauddeMacBook-Pro:/ julaud$ mongod --config /usr/local/etc/mongod.conf</div></pre></td></tr></table></figure>
<p>运行mongodb执行 mongod命令就可以<br>mongod –dbpath=/data/db</p>
<h2 id="连接MongoDb"><a href="#连接MongoDb" class="headerlink" title="连接MongoDb"></a>连接MongoDb</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">Last login: Thu Oct 29 20:36:01 on ttys000</div><div class="line">julauddeMacBook-Pro:~ julaud$ mongo</div><div class="line">MongoDB shell version: 3.0.7</div><div class="line">connecting to: test</div><div class="line">Welcome to the MongoDB shell.</div><div class="line">For interactive help, type &quot;help&quot;.</div><div class="line">For more comprehensive documentation, see</div><div class="line">	http://docs.mongodb.org/</div><div class="line">Questions? Try the support group</div><div class="line">	http://groups.google.com/group/mongodb-user</div><div class="line">Server has startup warnings:</div><div class="line">2015-10-30T22:55:29.874+0800 I CONTROL  [initandlisten]</div><div class="line">2015-10-30T22:55:29.874+0800 I CONTROL  [initandlisten] ** WARNING: soft rlimits too low. Number of files is 256, should be at least 1000</div><div class="line">&gt; show dbs</div><div class="line">local  0.078GB</div><div class="line">&gt;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://avatars0.githubusercontent.com/u/12947276?v=3&u=b5243b88f15147a53dc05609982089fc63da9412&s=400"
               alt="Julian" />
          <p class="site-author-name" itemprop="name">Julian</p>
          <p class="site-description motion-element" itemprop="description">一米阳光下，一本书，一个人，思念昉~</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">54</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">31</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">76</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Julian</span>
   <a href="http://www.miitbeian.gov.cn/">沪ICP备15000369号-2</a>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
     
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  
  

  

  
 
</body>
</html>
